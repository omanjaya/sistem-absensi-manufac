import{d as I,r as k,O as N,o as U,P,C as E,e as i,E as r,s as e,H as G,l as h,t as _,Q as p,W as D,U as J,V as T,F as $,z as F,v as d,f as S,q as c,j as q,B as b}from"./vendor-5hdk-FM1.js";import{a as H,u as O,l as f}from"./index-CpcTDv9q.js";const Q={class:"container mx-auto px-4 py-6"},W={class:"bg-white rounded-lg shadow"},K={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},R={class:"p-6"},X={class:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},Y={key:0,class:"text-center py-8"},Z={key:1,class:"overflow-x-auto"},tt={class:"min-w-full divide-y divide-gray-200"},et={class:"bg-white divide-y divide-gray-200"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm font-medium text-gray-900"},ot={class:"text-sm text-gray-500"},nt={class:"px-6 py-4 whitespace-nowrap"},rt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},it={key:0,class:"text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},lt={class:"px-6 py-4 whitespace-nowrap"},ut={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},pt=["onClick"],ct=["onClick"],gt={key:2,class:"text-center py-8"},bt=I({__name:"Leave",setup(mt){const l=H(),g=O(),m=k(!1),x=k([]),n=N({status:"",type:"",startDate:"",endDate:""}),v=async()=>{var a,t;try{m.value=!0;const o=await f.getLeaves(n);x.value=o.data||[]}catch(o){l.error(((t=(a=o.response)==null?void 0:a.data)==null?void 0:t.message)||"Gagal memuat data izin")}finally{m.value=!1}},j=async a=>{var t,o;try{await f.approveLeave(a.id),a.status="approved",l.success("Izin berhasil disetujui")}catch(s){l.error(((o=(t=s.response)==null?void 0:t.data)==null?void 0:o.message)||"Gagal menyetujui izin")}},C=async a=>{var t,o;try{await f.rejectLeave(a.id),a.status="rejected",l.success("Izin berhasil ditolak")}catch(s){l.error(((o=(t=s.response)==null?void 0:t.data)==null?void 0:o.message)||"Gagal menolak izin")}},M=a=>({sick:"bg-red-100 text-red-800",personal:"bg-blue-100 text-blue-800",annual:"bg-green-100 text-green-800",emergency:"bg-orange-100 text-orange-800"})[a]||"bg-gray-100 text-gray-800",z=a=>({sick:"Sakit",personal:"Pribadi",annual:"Tahunan",emergency:"Darurat"})[a]||a,V=a=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",L=a=>({pending:"Menunggu",approved:"Disetujui",rejected:"Ditolak"})[a]||a,w=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),A=(a,t)=>{const o=new Date(a),s=new Date(t),u=Math.abs(s.getTime()-o.getTime());return Math.ceil(u/(1e3*60*60*24))+1};return U(()=>{v()}),P(n,()=>{v()},{deep:!0}),(a,t)=>{const o=E("router-link");return r(),i("div",Q,[e("div",W,[e("div",K,[t[5]||(t[5]=e("h1",{class:"text-xl font-semibold text-gray-900"},"Daftar Izin/Cuti",-1)),G(o,{to:"/leaves/create",class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors"},{default:h(()=>t[4]||(t[4]=[_(" Ajukan Izin ")])),_:1,__:[4]})]),e("div",R,[e("div",X,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},t[6]||(t[6]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"pending"},"Menunggu",-1),e("option",{value:"approved"},"Disetujui",-1),e("option",{value:"rejected"},"Ditolak",-1)]),512),[[D,n.status]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Jenis",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.type=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},t[8]||(t[8]=[J('<option value="">Semua Jenis</option><option value="sick">Sakit</option><option value="personal">Pribadi</option><option value="annual">Tahunan</option><option value="emergency">Darurat</option>',5)]),512),[[D,n.type]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Mulai",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.startDate=s),type:"date",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[T,n.startDate]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Akhir",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.endDate=s),type:"date",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[T,n.endDate]])])]),m.value?(r(),i("div",Y,t[12]||(t[12]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Memuat data...",-1)]))):x.value.length>0?(r(),i("div",Z,[e("table",tt,[t[14]||(t[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pegawai "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jenis "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tanggal "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Durasi "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Aksi ")])],-1)),e("tbody",et,[(r(!0),i($,null,F(x.value,s=>{var u,y;return r(),i("tr",{key:s.id},[e("td",st,[e("div",at,d((u=s.user)==null?void 0:u.name),1),e("div",ot,d((y=s.user)==null?void 0:y.employee_id),1)]),e("td",nt,[e("span",{class:S([M(s.type),"px-2 py-1 text-xs font-medium rounded-full"])},d(z(s.type)),3)]),e("td",rt,[e("div",null,d(w(s.start_date)),1),s.end_date!==s.start_date?(r(),i("div",it," s/d "+d(w(s.end_date)),1)):c("",!0)]),e("td",dt,d(A(s.start_date,s.end_date))+" hari ",1),e("td",lt,[e("span",{class:S([V(s.status),"px-2 py-1 text-xs font-medium rounded-full"])},d(L(s.status)),3)]),e("td",ut,[s.status==="pending"&&b(g).isAdmin?(r(),i("button",{key:0,onClick:B=>j(s),class:"text-green-600 hover:text-green-900"}," Setujui ",8,pt)):c("",!0),s.status==="pending"&&b(g).isAdmin?(r(),i("button",{key:1,onClick:B=>C(s),class:"text-red-600 hover:text-red-900"}," Tolak ",8,ct)):c("",!0),s.status==="pending"&&!b(g).isAdmin?(r(),q(o,{key:2,to:`/leaves/${s.id}/edit`,class:"text-blue-600 hover:text-blue-900"},{default:h(()=>t[13]||(t[13]=[_(" Edit ")])),_:2,__:[13]},1032,["to"])):c("",!0)])])}),128))])])])):(r(),i("div",gt,t[15]||(t[15]=[e("p",{class:"text-gray-500"},"Tidak ada data izin ditemukan.",-1)])))])])])}}});export{bt as default};
