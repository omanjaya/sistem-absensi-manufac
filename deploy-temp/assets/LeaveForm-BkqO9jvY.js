import{d as h,N as D,X as M,r as j,c as p,O as T,o as V,C as z,e as g,E as f,s as a,v,y as U,q as C,Q as i,W as I,U as N,V as u,H as P,l as A,t as B}from"./vendor-5hdk-FM1.js";import{a as L,l as b}from"./index-CpcTDv9q.js";const S={class:"container mx-auto px-4 py-6"},q={class:"bg-white rounded-lg shadow"},F={class:"px-6 py-4 border-b border-gray-200"},E={class:"text-xl font-semibold text-gray-900"},G={class:"space-y-6"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},O=["value"],R={key:0},H={class:"mt-8 flex justify-end space-x-3"},K=["disabled"],$=h({__name:"LeaveForm",setup(Q){const c=D(),y=M(),l=L(),r=j(!1),m=p(()=>y.params.id),d=p(()=>!!m.value),t=T({type:"",start_date:"",end_date:"",reason:"",notes:"",document:null}),x=p(()=>{if(!t.start_date||!t.end_date)return"0 hari";const n=new Date(t.start_date),e=new Date(t.end_date),s=Math.abs(e.getTime()-n.getTime());return`${Math.ceil(s/(1e3*60*60*24))+1} hari`}),w=async()=>{var n,e;if(d.value)try{r.value=!0;const s=await b.getLeave(parseInt(m.value));Object.assign(t,{type:s.type,start_date:s.start_date,end_date:s.end_date,reason:s.reason,notes:s.notes||""})}catch(s){l.error(((e=(n=s.response)==null?void 0:n.data)==null?void 0:e.message)||"Gagal memuat data izin"),c.push("/leaves")}finally{r.value=!1}},k=n=>{var o;const e=n.target,s=(o=e.files)==null?void 0:o[0];if(s){if(s.size>2*1024*1024){l.error("Ukuran file terlalu besar. Maksimal 2MB."),e.value="";return}t.document=s}},_=async()=>{var n,e;if(new Date(t.end_date)<new Date(t.start_date)){l.error("Tanggal akhir tidak boleh sebelum tanggal mulai");return}try{r.value=!0;const s=new FormData;s.append("type",t.type),s.append("start_date",t.start_date),s.append("end_date",t.end_date),s.append("reason",t.reason),s.append("notes",t.notes),t.document&&s.append("document",t.document),d.value?(await b.updateLeave(parseInt(m.value),s),l.success("Pengajuan izin berhasil diperbarui")):(await b.createLeave(s),l.success("Pengajuan izin berhasil diajukan")),c.push("/leaves")}catch(s){l.error(((e=(n=s.response)==null?void 0:n.data)==null?void 0:e.message)||"Gagal menyimpan pengajuan izin")}finally{r.value=!1}};return V(()=>{d.value&&w()}),(n,e)=>{const s=z("router-link");return f(),g("div",S,[a("div",q,[a("div",F,[a("h1",E,v(d.value?"Edit Izin":"Ajukan Izin"),1)]),a("form",{onSubmit:U(_,["prevent"]),class:"p-6"},[a("div",G,[a("div",J,[a("div",null,[e[6]||(e[6]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Jenis Izin *",-1)),i(a("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.type=o),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},e[5]||(e[5]=[N('<option value="">Pilih Jenis Izin</option><option value="sick">Sakit</option><option value="personal">Pribadi</option><option value="annual">Tahunan</option><option value="emergency">Darurat</option>',5)]),512),[[I,t.type]])]),a("div",null,[e[7]||(e[7]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Mulai *",-1)),i(a("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.start_date=o),type:"date",required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[u,t.start_date]])]),a("div",null,[e[8]||(e[8]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Akhir *",-1)),i(a("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.end_date=o),type:"date",required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[u,t.end_date]])]),a("div",null,[e[9]||(e[9]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Durasi",-1)),a("input",{value:x.value,type:"text",readonly:"",class:"w-full rounded-md border-gray-300 bg-gray-50 shadow-sm",placeholder:"Akan dihitung otomatis"},null,8,O)])]),a("div",null,[e[10]||(e[10]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Alasan *",-1)),i(a("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.reason=o),required:"",rows:"4",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Jelaskan alasan pengajuan izin..."},null,512),[[u,t.reason]])]),t.type==="sick"?(f(),g("div",R,[e[11]||(e[11]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Surat Keterangan Dokter",-1)),a("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:k,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,32),e[12]||(e[12]=a("p",{class:"mt-1 text-sm text-gray-500"},"Format: PDF, JPG, PNG (Max 2MB)",-1))])):C("",!0),a("div",null,[e[13]||(e[13]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Catatan Tambahan",-1)),i(a("textarea",{"onUpdate:modelValue":e[4]||(e[4]=o=>t.notes=o),rows:"3",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Catatan tambahan (opsional)..."},null,512),[[u,t.notes]])])]),a("div",H,[P(s,{to:"/leaves",class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors"},{default:A(()=>e[14]||(e[14]=[B(" Batal ")])),_:1,__:[14]}),a("button",{type:"submit",disabled:r.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors"},v(r.value?"Menyimpan...":d.value?"Update":"Ajukan"),9,K)])],32)])])}}});export{$ as default};
