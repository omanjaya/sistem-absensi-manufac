import{d as P,r as v,O as E,c as I,o as M,P as N,e as o,E as r,s as e,Q as f,W as h,F as m,z as x,v as n}from"./vendor-5hdk-FM1.js";import{a as T,s as w,e as A,d as B}from"./index-CpcTDv9q.js";const C={class:"container mx-auto px-4 py-6"},L={class:"bg-white rounded-lg shadow"},V={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},$={class:"flex space-x-3"},J=["disabled"],U=["disabled"],Y={class:"p-6"},O={class:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4"},z=["value"],K=["value"],Q=["value"],R={key:0,class:"text-center py-8"},W={key:1,class:"overflow-x-auto"},q={class:"min-w-full divide-y divide-gray-200"},H={class:"bg-white divide-y divide-gray-200"},X={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm font-medium text-gray-900"},ee={class:"text-sm text-gray-500"},te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},re={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},ne={key:2,class:"text-center py-8"},ce=P({__name:"Salary",setup(ie){const c=T(),i=v(!1),g=v([]),_=v([]),l=E({month:new Date().getMonth()+1,year:new Date().getFullYear(),employeeId:""}),y=[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}],k=I(()=>{const s=new Date().getFullYear(),a=[];for(let t=s-2;t<=s+1;t++)a.push(t);return a}),b=async()=>{var s,a;try{i.value=!0;const t=await w.getSalaries(l);g.value=t.data||[]}catch(t){c.error(((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal memuat data gaji")}finally{i.value=!1}},j=async()=>{try{const s=await A.getEmployees();_.value=s.data||[]}catch(s){console.error("Failed to fetch employees:",s)}},S=async()=>{var s,a;try{i.value=!0,await w.generateSalary(l.month.toString(),l.year),c.success("Slip gaji berhasil digenerate"),await b()}catch(t){c.error(((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal generate slip gaji")}finally{i.value=!1}},D=async()=>{var s,a,t;try{i.value=!0;const d=await w.exportSalaries(l),u=`laporan-gaji-${(s=y.find(G=>G.value===l.month))==null?void 0:s.label}-${l.year}.xlsx`;B(d,u),c.success("Laporan gaji berhasil diunduh")}catch(d){c.error(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.message)||"Gagal mengunduh laporan gaji")}finally{i.value=!1}},p=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),F=(s,a)=>{var d;return`${(d=y.find(u=>u.value===s))==null?void 0:d.label} ${a}`};return M(()=>{j(),b()}),N(l,()=>{b()},{deep:!0}),(s,a)=>(r(),o("div",C,[e("div",L,[e("div",V,[a[3]||(a[3]=e("h1",{class:"text-xl font-semibold text-gray-900"},"Laporan Gaji",-1)),e("div",$,[e("button",{onClick:S,disabled:i.value,class:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors"}," Generate Gaji ",8,J),e("button",{onClick:D,disabled:i.value,class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors"}," Export Excel ",8,U)])]),e("div",Y,[e("div",O,[e("div",null,[a[4]||(a[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Bulan",-1)),f(e("select",{"onUpdate:modelValue":a[0]||(a[0]=t=>l.month=t),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[(r(),o(m,null,x(y,t=>e("option",{key:t.value,value:t.value},n(t.label),9,z)),64))],512),[[h,l.month]])]),e("div",null,[a[5]||(a[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tahun",-1)),f(e("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>l.year=t),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[(r(!0),o(m,null,x(k.value,t=>(r(),o("option",{key:t,value:t},n(t),9,K))),128))],512),[[h,l.year]])]),e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Pegawai",-1)),f(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>l.employeeId=t),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[a[6]||(a[6]=e("option",{value:""},"Semua Pegawai",-1)),(r(!0),o(m,null,x(_.value,t=>(r(),o("option",{key:t.id,value:t.id},n(t.name),9,Q))),128))],512),[[h,l.employeeId]])])]),i.value?(r(),o("div",R,a[8]||(a[8]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Memuat data...",-1)]))):g.value.length>0?(r(),o("div",W,[e("table",q,[a[9]||(a[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pegawai "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Periode "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Gaji Pokok "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tunjangan "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Lembur "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Potongan "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total ")])],-1)),e("tbody",H,[(r(!0),o(m,null,x(g.value,t=>{var d,u;return r(),o("tr",{key:t.id},[e("td",X,[e("div",Z,n((d=t.user)==null?void 0:d.name),1),e("div",ee,n((u=t.user)==null?void 0:u.employee_id),1)]),e("td",te,n(F(t.month,t.year)),1),e("td",ae,n(p(t.basic_salary)),1),e("td",se,n(p(t.allowances)),1),e("td",le,n(p(t.overtime_amount)),1),e("td",oe,n(p(t.deductions)),1),e("td",re,n(p(t.net_salary)),1)])}),128))])])])):(r(),o("div",ne,a[10]||(a[10]=[e("p",{class:"text-gray-500"},"Tidak ada data gaji ditemukan.",-1),e("p",{class:"text-sm text-gray-400 mt-1"},' Klik "Generate Gaji" untuk membuat slip gaji bulan ini. ',-1)])))])])]))}});export{ce as default};
