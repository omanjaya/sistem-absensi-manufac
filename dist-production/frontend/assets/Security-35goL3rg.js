import{_ as r,a as w}from"./Toast.vue_vue_type_style_index_0_scoped_caf7d6d7_lang-C7Vi0Lv3.js";import{_ as h,a as u}from"./MetricCard.vue_vue_type_script_setup_true_lang-MRCzEDgO.js";import{_ as f}from"./Form.vue_vue_type_script_setup_true_lang-Cf_hhWd7.js";import{_ as Y}from"./Modal.vue_vue_type_script_setup_true_lang-B2LSZhV7.js";import{_ as G}from"./Table.vue_vue_type_script_setup_true_lang-BoFOdIMn.js";import{a as J}from"./index-CpcTDv9q.js";import{e as v,E as g,s as t,d as K,r as c,o as Q,H as a,B as i,l as n,t as d,F as A,z as V,f as P,v as b}from"./vendor-5hdk-FM1.js";import{r as X}from"./UserGroupIcon-CVxCyeZM.js";import{r as ee}from"./ShieldCheckIcon-BLITuhfI.js";function te(k,o){return g(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}function se(k,o){return g(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"})])}const ie={class:"p-6 space-y-6"},ae={class:"flex items-center justify-between"},le={class:"flex items-center space-x-3"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},oe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},re={class:"space-y-3"},ue={class:"flex items-center space-x-3"},ce={class:"text-sm font-medium"},de={class:"text-xs text-gray-500"},me={class:"text-xs text-gray-400"},ve={class:"flex items-center space-x-2"},ge={class:"space-y-4"},pe={class:"flex items-center space-x-3"},ye={class:"text-sm font-medium"},fe={class:"text-xs text-gray-500"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},xe={class:"p-4 border rounded-lg"},_e={class:"flex items-center justify-between mb-3"},he={class:"p-4 border rounded-lg"},Se={class:"flex items-center justify-between mb-3"},we={class:"p-4 border rounded-lg"},ke={class:"flex items-center justify-between mb-3"},Le={class:"p-4 border rounded-lg"},Ce={class:"flex items-center justify-between mb-3"},Ae={class:"text-sm text-gray-500"},Ve={class:"space-y-6"},Pe={class:"space-y-4"},Me={class:"space-y-4"},Fe={class:"flex space-x-2"},qe=K({__name:"Security",setup(k){const o=J(),L=c("last_24_hours"),S=c(!1),p=c(!1),m=c({failedLogins:23,failedLoginsChange:-12,activeSessions:87,activeSessionsChange:5,securityScore:94,securityScoreChange:2,blockedIPs:15,blockedIPsChange:3}),x=c([{id:1,title:"Multiple Failed Login Attempts",description:"User admin@company.com - 5 failed attempts",severity:"High",timestamp:"2024-01-15 14:30:00"},{id:2,title:"Suspicious IP Activity",description:"IP 192.168.1.100 - Unusual access pattern",severity:"Medium",timestamp:"2024-01-15 13:45:00"},{id:3,title:"Session Timeout Warning",description:"Multiple users experiencing session timeouts",severity:"Low",timestamp:"2024-01-15 12:15:00"}]),M=c([{component:"Authentication Service",status:"healthy",description:"All systems operational"},{component:"Database Security",status:"healthy",description:"Encrypted connections active"},{component:"Firewall",status:"warning",description:"High traffic detected"},{component:"Audit System",status:"healthy",description:"Logging all activities"}]),F=c([{id:1,user:"admin@company.com",action:"Login",resource:"Dashboard",ip_address:"192.168.1.100",risk_level:"Low",timestamp:"2024-01-15 14:30:00"},{id:2,user:"john.doe@company.com",action:"Data Export",resource:"Employee Records",ip_address:"192.168.1.105",risk_level:"Medium",timestamp:"2024-01-15 14:25:00"},{id:3,user:"system",action:"Security Scan",resource:"All Systems",ip_address:"localhost",risk_level:"Low",timestamp:"2024-01-15 14:00:00"}]),y=c({minLength:8,requireSpecial:"true",expiration:90}),_=c({timeout:30,maxConcurrent:3}),E=[{value:"last_24_hours",label:"Last 24 Hours"},{value:"last_7_days",label:"Last 7 Days"},{value:"last_30_days",label:"Last 30 Days"}],R=[{value:"true",label:"Yes"},{value:"false",label:"No"}],$=[{key:"user",label:"User",sortable:!0},{key:"action",label:"Action",sortable:!0},{key:"resource",label:"Resource",sortable:!0},{key:"ip_address",label:"IP Address",sortable:!0},{key:"risk_level",label:"Risk Level",sortable:!0},{key:"timestamp",label:"Timestamp",sortable:!0,type:"date"}],D=[{key:"action",label:"Action",options:[{value:"Login",label:"Login"},{value:"Data Export",label:"Data Export"},{value:"Security Scan",label:"Security Scan"}]},{key:"risk_level",label:"Risk Level",options:[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]}];function T(l){return{High:"bg-red-500",Medium:"bg-yellow-500",Low:"bg-green-500"}[l]||"bg-gray-500"}function j(l){return{High:"danger",Medium:"warning",Low:"success"}[l]||"gray"}function H(l){return{Login:"info","Data Export":"warning","Security Scan":"primary"}[l]||"gray"}function U(l){return{Low:"success",Medium:"warning",High:"danger"}[l]||"gray"}function C(l){return new Date(l).toLocaleString()}async function z(){try{await new Promise(l=>setTimeout(l,1e3)),o.success("Security report exported successfully!")}catch{o.error("Failed to export security report")}}function I(l){const e=x.value.findIndex(s=>s.id===l);e>-1&&(x.value.splice(e,1),o.success("Alert resolved successfully"))}function q(){o.info("Redirecting to 2FA configuration...")}function B(){p.value=!0}function N(){p.value=!0}function O(){o.info("Scrolling to audit logs section...")}async function Z(){S.value=!0;try{await new Promise(l=>setTimeout(l,1e3)),o.success("Audit logs refreshed")}catch{o.error("Failed to refresh logs")}finally{S.value=!1}}async function W(){try{await new Promise(l=>setTimeout(l,1e3)),p.value=!1,o.success("Security settings saved successfully!")}catch{o.error("Failed to save security settings")}}return Q(()=>{}),(l,e)=>(g(),v("div",ie,[t("div",ae,[e[10]||(e[10]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Security Dashboard"),t("p",{class:"text-gray-600"},"Monitor system security and audit logs")],-1)),t("div",le,[e[9]||(e[9]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 rounded-full bg-green-500"}),t("span",{class:"text-sm font-medium text-gray-700"},"System Secure")],-1)),a(i(f),{type:"select",modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=s=>L.value=s),options:E,placeholder:"Select timeframe"},null,8,["modelValue"]),a(i(r),{variant:"primary",onClick:z},{default:n(()=>e[8]||(e[8]=[d(" Export Report ")])),_:1,__:[8]})])]),t("div",ne,[a(i(h),{label:"Failed Logins",value:m.value.failedLogins,icon:i(se),"icon-bg":"red",change:m.value.failedLoginsChange,"change-unit":"",description:"last 24 hours"},null,8,["value","icon","change"]),a(i(h),{label:"Active Sessions",value:m.value.activeSessions,icon:i(X),"icon-bg":"blue",change:m.value.activeSessionsChange,"change-unit":"",description:"currently online"},null,8,["value","icon","change"]),a(i(h),{label:"Security Score",value:m.value.securityScore+"/100",icon:i(ee),"icon-bg":"green",change:m.value.securityScoreChange,description:"overall rating"},null,8,["value","icon","change"]),a(i(h),{label:"Blocked IPs",value:m.value.blockedIPs,icon:i(te),"icon-bg":"yellow",change:m.value.blockedIPsChange,"change-unit":"",description:"auto-blocked"},null,8,["value","icon","change"])]),t("div",oe,[a(i(w),{title:"Security Alerts",subtitle:"Recent security incidents"},{headerActions:n(()=>[a(i(u),{variant:"danger",label:`${x.value.length} active`},null,8,["label"])]),default:n(()=>[t("div",re,[(g(!0),v(A,null,V(x.value,s=>(g(),v("div",{key:s.id,class:"flex items-center justify-between p-3 rounded-lg border"},[t("div",ue,[t("div",{class:P(["w-2 h-2 rounded-full",T(s.severity)])},null,2),t("div",null,[t("p",ce,b(s.title),1),t("p",de,b(s.description),1),t("p",me,b(C(s.timestamp)),1)])]),t("div",ve,[a(i(u),{variant:j(s.severity),label:s.severity},null,8,["variant","label"]),a(i(r),{variant:"ghost",size:"sm",onClick:Ee=>I(s.id)},{default:n(()=>e[11]||(e[11]=[d(" Resolve ")])),_:2,__:[11]},1032,["onClick"])])]))),128))])]),_:1}),a(i(w),{title:"System Status",subtitle:"Security system health"},{default:n(()=>[t("div",ge,[(g(!0),v(A,null,V(M.value,s=>(g(),v("div",{key:s.component,class:"flex items-center justify-between"},[t("div",pe,[t("div",{class:P(["w-3 h-3 rounded-full",s.status==="healthy"?"bg-green-500":s.status==="warning"?"bg-yellow-500":"bg-red-500"])},null,2),t("div",null,[t("p",ye,b(s.component),1),t("p",fe,b(s.description),1)])]),a(i(u),{variant:s.status==="healthy"?"success":s.status==="warning"?"warning":"danger",label:s.status},null,8,["variant","label"])]))),128))])]),_:1})]),a(i(w),{title:"Security Controls",subtitle:"Manage system security settings"},{default:n(()=>[t("div",be,[t("div",xe,[t("div",_e,[e[12]||(e[12]=t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Two-Factor Authentication"),t("p",{class:"text-xs text-gray-500"},"Require 2FA for all admin accounts")],-1)),a(i(u),{variant:"success",label:"Enabled"})]),a(i(r),{variant:"secondary",size:"sm",onClick:q},{default:n(()=>e[13]||(e[13]=[d(" Configure 2FA ")])),_:1,__:[13]})]),t("div",he,[t("div",Se,[e[14]||(e[14]=t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Password Policy"),t("p",{class:"text-xs text-gray-500"},"Enforce strong password requirements")],-1)),a(i(u),{variant:"success",label:"Active"})]),a(i(r),{variant:"secondary",size:"sm",onClick:B},{default:n(()=>e[15]||(e[15]=[d(" Edit Policy ")])),_:1,__:[15]})]),t("div",we,[t("div",ke,[e[16]||(e[16]=t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Session Management"),t("p",{class:"text-xs text-gray-500"},"Auto-logout after 30 minutes")],-1)),a(i(u),{variant:"info",label:"30 min"})]),a(i(r),{variant:"secondary",size:"sm",onClick:N},{default:n(()=>e[17]||(e[17]=[d(" Configure ")])),_:1,__:[17]})]),t("div",Le,[t("div",Ce,[e[18]||(e[18]=t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Audit Logging"),t("p",{class:"text-xs text-gray-500"},"Track all system activities")],-1)),a(i(u),{variant:"success",label:"Active"})]),a(i(r),{variant:"secondary",size:"sm",onClick:O},{default:n(()=>e[19]||(e[19]=[d(" View Logs ")])),_:1,__:[19]})])])]),_:1}),a(i(G),{title:"Audit Logs",subtitle:"Complete system activity history",data:F.value,columns:$,searchable:"","search-placeholder":"Search logs...",filterable:!0,filters:D,paginated:!0,"page-size":10,loading:S.value},{headerActions:n(()=>[a(i(r),{variant:"secondary",onClick:Z},{default:n(()=>e[20]||(e[20]=[d(" Refresh ")])),_:1,__:[20]})]),"cell-action":n(({value:s})=>[a(i(u),{variant:H(s),label:s},null,8,["variant","label"])]),"cell-risk_level":n(({value:s})=>[a(i(u),{variant:U(s),label:s},null,8,["variant","label"])]),"cell-timestamp":n(({value:s})=>[t("span",Ae,b(C(s)),1)]),_:1},8,["data","loading"]),a(i(Y),{show:p.value,"onUpdate:show":e[7]||(e[7]=s=>p.value=s),title:"Security Settings",size:"lg"},{footer:n(()=>[t("div",Fe,[a(i(r),{variant:"secondary",onClick:e[6]||(e[6]=s=>p.value=!1)},{default:n(()=>e[23]||(e[23]=[d("Cancel")])),_:1,__:[23]}),a(i(r),{variant:"primary",onClick:W},{default:n(()=>e[24]||(e[24]=[d("Save Settings")])),_:1,__:[24]})])]),default:n(()=>[t("div",Ve,[t("div",null,[e[21]||(e[21]=t("h4",{class:"text-md font-medium mb-4"},"Password Policy",-1)),t("div",Pe,[a(i(f),{modelValue:y.value.minLength,"onUpdate:modelValue":e[1]||(e[1]=s=>y.value.minLength=s),type:"number",label:"Minimum Length",required:!0},null,8,["modelValue"]),a(i(f),{modelValue:y.value.requireSpecial,"onUpdate:modelValue":e[2]||(e[2]=s=>y.value.requireSpecial=s),type:"select",label:"Require Special Characters",options:R},null,8,["modelValue"]),a(i(f),{modelValue:y.value.expiration,"onUpdate:modelValue":e[3]||(e[3]=s=>y.value.expiration=s),type:"number",label:"Password Expiration (days)"},null,8,["modelValue"])])]),t("div",null,[e[22]||(e[22]=t("h4",{class:"text-md font-medium mb-4"},"Session Settings",-1)),t("div",Me,[a(i(f),{modelValue:_.value.timeout,"onUpdate:modelValue":e[4]||(e[4]=s=>_.value.timeout=s),type:"number",label:"Session Timeout (minutes)",required:!0},null,8,["modelValue"]),a(i(f),{modelValue:_.value.maxConcurrent,"onUpdate:modelValue":e[5]||(e[5]=s=>_.value.maxConcurrent=s),type:"number",label:"Max Concurrent Sessions"},null,8,["modelValue"])])])])]),_:1},8,["show"])]))}});export{qe as default};
